<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>14</title>
  <style type="text/css" media="screen">
    body {
      background-color: #234;
    }
    #container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      background-color: #789;
    }
    svg {
      border: 1px solid limegreen;
      transition: border-color 250ms, filter 250ms;
    }
  </style>
</head>
<body>
  <div id="container"></div>

  <script type="module">
    import * as d3 from 'https://cdn.jsdelivr.net/npm/d3@7.9.0/+esm';

    const input = `p=43,30 v=73,-79\np=20,21 v=-72,96\np=24,57 v=-95,97\np=29,86 v=-19,83\np=30,80 v=-91,-16\np=45,19 v=30,-89\np=12,29 v=45,-46\np=86,51 v=-31,8\np=87,41 v=19,-16\np=86,1 v=-48,-91\np=20,18 v=-37,36\np=12,28 v=99,26\np=30,14 v=41,-2\np=55,101 v=29,-78\np=58,100 v=-89,25\np=87,45 v=79,16\np=70,29 v=-92,-45\np=31,1 v=-59,-34\np=46,45 v=19,-46\np=97,76 v=93,-6\np=83,50 v=53,66\np=0,37 v=89,-72\np=3,39 v=-13,-79\np=69,14 v=29,-65\np=45,81 v=61,-20\np=94,28 v=76,3\np=37,73 v=81,-29\np=7,15 v=-8,-18\np=21,57 v=97,-78\np=39,66 v=88,70\np=29,40 v=82,-87\np=69,68 v=38,-6\np=64,79 v=-81,-85\np=96,76 v=43,-29\np=91,77 v=-37,66\np=49,22 v=25,38\np=45,79 v=-68,26\np=14,53 v=-43,-37\np=33,21 v=-90,94\np=39,78 v=-71,91\np=24,36 v=87,-63\np=79,91 v=34,11\np=22,66 v=87,66\np=14,65 v=47,74\np=33,102 v=-11,-87\np=80,27 v=-72,-48\np=75,60 v=-39,65\np=14,61 v=88,49\np=49,67 v=10,-29\np=16,15 v=55,-3\np=73,86 v=54,35\np=2,71 v=-94,15\np=19,91 v=83,-60\np=87,41 v=-4,76\np=31,96 v=91,85\np=97,13 v=8,14\np=76,15 v=39,70\np=22,48 v=49,-62\np=33,43 v=-66,1\np=7,93 v=-3,-83\np=70,35 v=84,-95\np=38,85 v=26,-52\np=26,8 v=26,-26\np=62,72 v=-65,-98\np=48,89 v=69,-66\np=93,51 v=-78,25\np=38,62 v=72,56\np=85,26 v=-47,-1\np=99,13 v=-94,-48\np=75,28 v=-87,-98\np=75,102 v=-71,93\np=28,34 v=46,-37\np=66,76 v=70,3\np=26,79 v=-68,85\np=7,102 v=22,99\np=1,28 v=31,24\np=62,25 v=-16,-96\np=96,95 v=-93,28\np=70,56 v=-88,-27\np=1,90 v=-7,-76\np=69,70 v=65,99\np=21,79 v=-24,3\np=1,35 v=-3,-24\np=44,73 v=-60,-61\np=93,89 v=13,60\np=26,95 v=82,68\np=21,19 v=-74,30\np=8,70 v=-3,-61\np=26,52 v=-14,56\np=14,43 v=27,95\np=62,94 v=-21,85\np=49,91 v=30,-75\np=38,101 v=-45,-55\np=69,75 v=-16,66\np=52,25 v=8,-72\np=22,66 v=46,-92\np=10,28 v=22,-8\np=30,88 v=53,6\np=76,40 v=13,16\np=65,15 v=59,-66\np=61,50 v=30,64\np=58,61 v=40,34\np=33,77 v=35,-48\np=35,10 v=-90,84\np=15,43 v=-8,-64\np=92,82 v=-73,-61\np=17,83 v=-14,50\np=71,43 v=-30,-91\np=30,31 v=40,-36\np=18,21 v=-96,-29\np=25,96 v=26,-91\np=96,20 v=99,22\np=13,53 v=97,-37\np=0,29 v=-12,-79\np=78,62 v=23,-29\np=100,62 v=-63,35\np=35,66 v=20,-74\np=92,29 v=84,-23\np=61,90 v=30,83\np=3,42 v=-18,-79\np=79,41 v=44,95\np=80,27 v=-73,-89\np=81,4 v=29,21\np=66,96 v=-20,-90\np=18,66 v=-75,74\np=59,92 v=45,13\np=76,58 v=-37,-54\np=6,54 v=93,-15\np=84,56 v=-12,26\np=25,84 v=-83,19\np=35,19 v=46,-56\np=97,71 v=43,-77\np=22,94 v=-29,-51\np=40,63 v=42,14\np=86,33 v=54,-41\np=0,47 v=27,18\np=77,9 v=-95,-41\np=53,44 v=-61,64\np=2,53 v=8,16\np=66,71 v=-37,-6\np=51,25 v=-77,24\np=99,24 v=-17,-45\np=60,76 v=-56,-13\np=45,9 v=-15,-90\np=43,86 v=71,-44\np=35,40 v=-15,-24\np=96,74 v=-53,90\np=29,38 v=-14,-71\np=39,24 v=-55,39\np=98,65 v=38,-44\np=66,52 v=24,58\np=12,1 v=27,-66\np=38,77 v=-24,20\np=83,55 v=-53,-15\np=92,30 v=58,-64\np=36,49 v=-90,96\np=98,93 v=-79,-83\np=46,97 v=91,6\np=48,27 v=-67,-78\np=6,88 v=-3,-68\np=4,84 v=-13,60\np=38,46 v=11,64\np=62,17 v=-5,-97\np=52,2 v=-86,-89\np=97,86 v=69,36\np=57,1 v=65,-98\np=18,17 v=14,55\np=5,87 v=13,67\np=70,59 v=80,-22\np=76,89 v=-82,12\np=46,27 v=91,47\np=15,101 v=57,92\np=43,67 v=-25,-92\np=81,26 v=84,31\np=16,17 v=22,22\np=52,67 v=-66,66\np=64,92 v=-31,-51\np=89,47 v=-83,-55\np=9,88 v=-74,-99\np=38,41 v=71,-71\np=81,12 v=38,23\np=24,47 v=-50,34\np=58,35 v=29,28\np=17,47 v=32,18\np=99,20 v=28,-1\np=73,43 v=29,-55\np=45,34 v=-11,-48\np=57,1 v=71,-75\np=27,57 v=-89,62\np=65,63 v=-71,-60\np=44,75 v=-25,78\np=31,12 v=19,-75\np=15,28 v=-21,-2\np=43,36 v=6,-70\np=46,78 v=-85,66\np=48,56 v=94,-97\np=91,86 v=-71,-73\np=61,41 v=-52,-36\np=49,77 v=-63,-57\np=1,59 v=-7,-37\np=73,31 v=24,46\np=42,41 v=-55,40\np=62,64 v=-57,9\np=78,27 v=-37,-39\np=32,45 v=97,-87\np=3,1 v=29,-30\np=68,64 v=-92,-21\np=25,10 v=82,85\np=28,32 v=79,25\np=21,79 v=51,66\np=46,99 v=-20,-28\np=9,42 v=-99,71\np=99,29 v=-3,30\np=47,94 v=15,13\np=82,73 v=68,91\np=10,60 v=-23,33\np=75,75 v=54,74\np=98,28 v=-53,32\np=28,84 v=21,-45\np=75,97 v=-85,5\np=66,79 v=-60,-93\np=79,86 v=64,75\np=3,65 v=98,50\np=75,64 v=39,57\np=1,11 v=-73,-11\np=36,34 v=-65,95\np=50,94 v=-96,5\np=12,37 v=97,64\np=81,77 v=60,-46\np=74,41 v=-35,-64\np=79,1 v=77,-80\np=78,0 v=75,46\np=50,60 v=25,65\np=61,90 v=-49,-68\np=7,49 v=82,-48\np=55,1 v=-36,83\np=39,45 v=60,83\np=42,79 v=-35,-52\np=62,95 v=-97,-60\np=63,88 v=-21,76\np=49,39 v=80,24\np=81,53 v=44,-28\np=67,69 v=-7,16\np=50,76 v=40,-59\np=86,78 v=94,-38\np=52,84 v=46,83\np=0,51 v=-12,-93\np=6,66 v=-33,78\np=0,5 v=-99,-82\np=98,33 v=-28,-38\np=48,19 v=42,81\np=11,1 v=-89,-91\np=62,99 v=60,76\np=36,62 v=99,-22\np=1,59 v=42,88\np=96,62 v=-28,57\np=76,102 v=-85,11\np=86,90 v=-17,-43\np=41,95 v=75,11\np=73,85 v=-72,60\np=40,38 v=35,64\np=11,11 v=7,-34\np=21,50 v=11,64\np=1,21 v=-68,70\np=70,73 v=44,58\np=97,51 v=43,-46\np=34,23 v=57,55\np=56,29 v=79,18\np=38,64 v=31,50\np=77,16 v=-9,56\np=3,53 v=-8,-23\np=21,33 v=-79,9\np=31,48 v=-95,72\np=56,97 v=-66,-75\np=96,90 v=-83,75\np=41,45 v=80,3\np=93,18 v=-78,7\np=60,13 v=-86,76\np=24,13 v=77,54\np=28,47 v=21,-85\np=19,82 v=33,-93\np=32,45 v=21,40\np=43,84 v=-45,-67\np=52,46 v=-2,34\np=92,64 v=93,81\np=54,67 v=-76,3\np=12,54 v=98,-29\np=100,62 v=-33,-93\np=11,26 v=39,-16\np=7,98 v=-30,-93\np=53,52 v=40,-62\np=74,68 v=-36,-20\np=4,37 v=-44,96\np=58,22 v=-66,23\np=63,1 v=-41,21\np=92,47 v=-73,33\np=38,84 v=17,-94\np=94,41 v=-98,-87\np=78,81 v=-57,-52\np=14,28 v=-95,-31\np=100,67 v=48,-5\np=66,29 v=90,-72\np=86,32 v=67,-8\np=87,101 v=94,85\np=54,65 v=-45,-45\np=0,5 v=-53,44\np=4,68 v=73,11\np=64,31 v=-92,55\np=69,59 v=-92,-70\np=37,30 v=80,-11\np=100,57 v=93,9\np=19,99 v=31,-18\np=17,42 v=62,56\np=28,93 v=27,5\np=53,88 v=30,-28\np=19,25 v=82,48\np=42,78 v=-66,9\np=63,39 v=60,8\np=1,57 v=51,42\np=62,6 v=-5,-42\np=76,43 v=-88,48\np=99,1 v=-43,-91\np=93,40 v=-2,40\np=41,68 v=-97,20\np=28,99 v=-4,77\np=78,13 v=-82,-34\np=82,27 v=79,-40\np=90,64 v=33,-22\np=20,85 v=-81,-34\np=70,19 v=14,86\np=66,67 v=-52,25\np=55,86 v=25,-44\np=61,10 v=50,46\np=60,50 v=-15,96\np=30,71 v=16,19\np=70,8 v=-82,6\np=77,5 v=-83,93\np=32,21 v=-11,-54\np=37,66 v=-63,18\np=97,80 v=33,43\np=47,81 v=31,-17\np=20,71 v=62,-5\np=6,13 v=67,30\np=3,60 v=71,75\np=95,57 v=28,-5\np=29,40 v=77,87\np=40,100 v=-20,13\np=24,32 v=87,55\np=30,94 v=-4,-82\np=11,102 v=-58,37\np=0,26 v=48,-25\np=0,26 v=61,-38\np=81,15 v=65,54\np=19,59 v=-14,-22\np=51,100 v=-24,17\np=96,14 v=48,-18\np=0,86 v=68,-82\np=10,27 v=93,78\np=85,77 v=-9,-80\np=84,43 v=-2,96\np=46,22 v=-20,-40\np=68,75 v=24,50\np=29,89 v=-19,67\np=65,78 v=65,11\np=82,11 v=95,85\np=83,48 v=18,26\np=61,58 v=38,19\np=35,77 v=36,-99\np=63,6 v=-31,-42\np=98,71 v=22,99\np=2,25 v=-43,-64\np=54,67 v=-66,-5\np=10,88 v=-25,2\np=83,71 v=17,50\np=88,19 v=-22,46\np=20,2 v=42,-26\np=8,44 v=-48,-6\np=11,15 v=-58,-34\np=51,54 v=55,-7\np=15,70 v=-24,-75\np=74,62 v=68,-31\np=75,84 v=14,83\np=48,25 v=-15,-88\np=47,100 v=81,-90\np=88,6 v=-2,22\np=26,85 v=-24,-83\np=95,67 v=76,83\np=19,101 v=-34,52\np=46,51 v=76,-22\np=90,0 v=33,-27\np=6,1 v=63,-90\np=8,72 v=98,-76\np=99,89 v=56,59\np=22,84 v=-44,-60\np=42,25 v=-38,82\np=59,45 v=-31,-63\np=14,9 v=-95,1\np=2,45 v=-58,-2\np=65,46 v=-1,49\np=74,13 v=84,5\np=9,62 v=-19,-15\np=61,76 v=-86,-56\np=97,44 v=-84,-38\np=61,27 v=65,-9\np=22,73 v=47,50\np=1,57 v=-43,57\np=76,77 v=-47,-20\np=77,24 v=-32,-1\np=53,22 v=45,46\np=38,81 v=61,-92\np=92,58 v=-57,-21\np=86,18 v=63,6\np=40,90 v=87,3\np=15,25 v=-59,-64\np=20,6 v=-8,52\np=5,76 v=-95,-98\np=43,61 v=-52,29\np=83,34 v=36,18\np=2,81 v=47,66\np=7,52 v=12,65\np=22,0 v=12,-49\np=80,59 v=-17,49\np=60,20 v=30,41\np=47,76 v=14,21\np=43,96 v=71,37\np=11,1 v=92,-43\np=57,88 v=-42,-46\np=70,70 v=4,-13\np=61,31 v=-11,-56\np=31,28 v=45,40\np=43,64 v=-10,2\np=53,98 v=-86,-98\np=39,96 v=-40,-35\np=53,82 v=38,-84\np=3,85 v=-94,4\np=44,4 v=75,11\np=74,49 v=-69,-81\np=0,73 v=78,-30\np=90,77 v=-20,84\np=3,5 v=-3,-82\np=37,18 v=96,-8\np=20,100 v=87,-82\np=93,59 v=-73,42\np=90,82 v=43,-84\np=53,73 v=-91,-53\np=26,14 v=97,-26\np=90,16 v=18,-41\np=28,2 v=-5,-78\np=46,1 v=-11,17\np=33,1 v=-65,-98\np=80,24 v=-16,-80\np=19,83 v=47,-92\np=10,49 v=-14,-31\np=5,29 v=-84,30\np=80,61 v=11,-72\np=36,35 v=-14,78\np=85,24 v=23,-63\np=63,39 v=45,-16\np=10,95 v=4,88\np=14,56 v=-67,10\np=9,2 v=-64,13\np=79,63 v=-73,65\np=38,7 v=24,96\np=1,7 v=-33,-65\np=16,13 v=39,8\np=32,84 v=92,58\np=85,83 v=83,-49\np=55,102 v=-42,56\np=14,43 v=-18,-64\np=75,38 v=29,79\np=25,3 v=-44,78\np=34,47 v=-26,-22\np=88,56 v=13,-94\np=45,17 v=-90,-58\np=85,20 v=-17,14\np=49,2 v=-49,18\np=39,83 v=82,-67\np=38,76 v=-98,-79\np=46,94 v=54,14\np=11,75 v=-63,13\np=59,51 v=-92,-67\np=96,69 v=68,-93\np=42,96 v=-68,-84\np=97,19 v=-58,-2\np=21,33 v=-8,39\np=28,6 v=82,93\np=15,74 v=-80,-50\np=84,24 v=-28,30\np=84,74 v=99,27\np=2,23 v=99,-1\np=65,100 v=59,-82\np=89,99 v=29,-97\np=85,56 v=-92,91\np=90,81 v=-83,-12\np=94,21 v=33,-97\np=67,34 v=82,-19\np=88,37 v=-43,41\np=88,67 v=54,-14\np=35,98 v=29,-22\np=19,9 v=-44,-18`;
    let robots = input.split('\n').map(line => {
      const pattern = new RegExp(/^p=(-?\d+),(-?\d+) v=(-?\d+),(-?\d+)$/);
      const [, x, y, dx, dy] = line.match(pattern);
      return { x: +x, y: +y, dx: +dx, dy: +dy };
    });
    
    let t = 0; // time elapsed

    const [height, width] = [103, 101];
    const framelapse = 1; // ms
    
    const container = d3.select('#container');
    const svg = container.append('svg')
      .attr('width', width)
      .attr('height', height)
      .attr('viewBox', `0 0 ${ width } ${ height }`)
      .attr('preserveAspectRatio', 'xMidYMid meet');

    let timer = d3.interval(() => tick(), framelapse);

    function startAnimation() {
      if (timer) return;
      timer = d3.interval(() => tick(), framelapse);
    }

    function stopAnimation() {
      if (!timer) return;
      timer.stop();
      timer = null;
    }

    svg.on('mouseover', () => {
      svg.style('border', '1px solid crimson');
      svg.style('filter', 'drop-shadow(0 0 4px rgba(0, 0, 0, 0.3)');
      stopAnimation();
    });

    svg.on('mouseout', () => {
      svg.style('border', '1px solid limegreen');
      svg.style('filter', 'drop-shadow(0 0 2px rgba(0, 0, 0, 0.1)');
      startAnimation();
    });
    
    svg.on('wheel', (event) => {
      event.preventDefault();
      if (event.wheelDelta < 0) {
        tick(false);
      } else if (event.wheelDelta > 0) {
        tick(true);
      }
    });

    const counter = container.append('span').text(t);

    const circles = svg.selectAll('circle')
      .data(robots)
      .enter()
      .append('circle')
        .attr('cx', d => d.x)
        .attr('cy', d => d.y)
        .attr('r', 1)
        .style('fill', 'coral');

    function tick(forward = true) {
      t = forward ? t + 1 : t - 1;
      const c = forward ? 1 : -1;

      const modWidth = n => (n + width) % width;
      const modHeight = n => (n + height) % height;
      const step = d => {
        d.x = modWidth(d.x + c * d.dx);
        d.y = modWidth(d.y + c * d.dy);
      };

      circles
        .data(robots)
        .each(step)
        .attr('cx', d => d.x)
        .attr('cy', d => d.y);

      counter.text(t);
    }

    startAnimation();
  </script>
</body>
</html>